import{r as l,j as e,y as x,a as u}from"./app-CqiCJa1v.js";import{A as p,a as h}from"./Autocomplete-G4CmO8Lz.js";import{P as j}from"./PrimaryButton-_cJx4w-z.js";import{g as f,b as g,c as b}from"./functions-BFIscfgD.js";import{X as y}from"./transition-IEciN-pB.js";import{c as N,A as C}from"./AuthenticatedLayout-Cbqz5ayS.js";import{S as w,T as k}from"./trash-2-B8oF2GEu.js";import{P as v}from"./Pagination-DMstKf1b.js";import{E as L}from"./EmptyList-YVd14JWH.js";import{I as F}from"./InsideLayout-DVl-DAn7.js";import{C as P}from"./circle-plus-Ck-tANEV.js";import"./loader-circle-qsH-V_QL.js";/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=N("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);function S(){const t=new URLSearchParams(window.location.search),[s,r]=l.useState({}),n=a=>{a.preventDefault(),x.get(route("contracts.index"),{...s})};return e.jsx("div",{className:"mb-5 py-3",children:e.jsxs("form",{onSubmit:n,method:"get",className:"flex items-end gap-2",children:[e.jsx(p,{placeholder:"إختر زبونا",dataFunction:async a=>h("clients",a),defaultValue:t.get("client_id"),choiceHandler:a=>r(i=>({...i,client_id:a})),listItemAtributeName:"full_name",id:"contract-filter-form",label:"الزبون"}),e.jsx(j,{type:"submit",className:"w-24",children:"بحث"})]})})}const T=({bonds:t})=>e.jsx("div",{className:"flex max-w-28 flex-wrap gap-1",children:t.map((s,r)=>e.jsx("div",{className:`h-4 w-4 rounded-full ${s}`},r))}),d=l.createContext(),o=({children:t})=>{const[s,r]=l.useState(!1),n=a=>{a.stopPropagation(),r(i=>!i)};return e.jsx(d.Provider,{value:{open:s,setOpen:r,toggleOpen:n},children:e.jsx("div",{className:"relative",children:t})})},E=({children:t})=>{const{open:s,setOpen:r,toggleOpen:n}=l.useContext(d);return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:n,children:t}),s&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>r(!1)})]})},A=({align:t="right",width:s="48",contentClasses:r="py-1 bg-white",children:n})=>{const{open:a,setOpen:i}=l.useContext(d);let c="origin-top";t==="left"?c="ltr:origin-top-left rtl:origin-top-right start-0":t==="right"&&(c="ltr:origin-top-right rtl:origin-top-left end-0");let m="";return s==="48"&&(m="w-48"),e.jsx(e.Fragment,{children:e.jsx(y,{show:a,enter:"transition ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsx("div",{className:`absolute z-50 mt-2 rounded-md shadow-lg ${c} ${m}`,onClick:()=>i(!1),children:e.jsx("div",{className:"rounded-md ring-1 ring-black ring-opacity-5 "+r,children:n})})})})},I=({className:t="",children:s,...r})=>e.jsx(u,{...r,className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none "+t,children:s});o.Trigger=E;o.Content=A;o.Link=I;function O({contractId:t}){return e.jsxs(o,{children:[e.jsx(o.Trigger,{children:e.jsx("button",{className:"h-8 w-8 rounded-full bg-gray-200",children:e.jsx(D,{className:"mx-auto"})})}),e.jsxs(o.Content,{children:[e.jsxs(o.Link,{href:route("contracts.edit",t),children:[e.jsx(w,{className:"inline-block"})," تعديل"]}),e.jsxs(o.Link,{href:route("contracts.destroy",t),method:"delete",as:"button",children:[e.jsx(k,{className:"inline-block"})," حذف"]})]})]})}function _({contract:t}){function s(){x.get(route("contracts.show",t.id))}const r=l.useMemo(()=>t.bonds.map(a=>f(a.status,a.payement_date)),[t.bonds]),n=l.useMemo(()=>g(r),[r]);return e.jsxs("tr",{className:"cursor-pointer",children:[e.jsx("td",{onClick:s,className:"hidden border-b py-4 text-start md:block",children:e.jsx("span",{className:`block rounded-lg py-2 text-center font-bold ${n.color}`,children:n.label})}),e.jsx("td",{onClick:s,className:"border-b py-4 text-start md:mr-5 md:pr-10",children:t.client.full_name}),e.jsx("td",{onClick:s,className:"me-5 border-b py-4 text-start",children:new Date(b(t.bonds)).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsx("td",{onClick:s,className:"me-5 w-28 border-b py-4 text-start md:w-44 lg:w-72",children:e.jsx(T,{bonds:r})}),e.jsx("td",{className:"pr-3",children:e.jsx(O,{contractId:t.id})})]})}function $({contracts:t}){return e.jsxs("table",{className:"mt-12 w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"w-full border-b-2 border-b-black",children:[e.jsx("th",{scope:"col",className:"small:text-xs hidden pb-4 text-start text-base md:block",children:"الحالة"}),e.jsx("th",{scope:"col",className:"small:text-xs me-5 pb-4 text-start md:pr-10",children:"اسم الزبون"}),e.jsx("th",{scope:"col",className:"small:text-xs me-5 pb-4 text-start",children:"تاريخ الدفع التالي"}),e.jsx("th",{scope:"col",className:"small:text-xs me-5 pb-4 text-start",children:"الدفعات"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.data.map(s=>e.jsx(_,{contract:s},s.id))}),e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:4,children:e.jsx("div",{className:"mt-12 flex justify-center",children:e.jsx(v,{data:t})})})})})]})}function Q({contracts:t}){return e.jsx(C,{children:e.jsxs(F,{headerTitle:"العقود",headerLink:[{label:"إضافة عقد جديد",url:"/contracts/create",icon:P}],children:[e.jsx(S,{}),t.data.length>0?e.jsx($,{contracts:t}):e.jsx(L,{model:"عقود"})]})})}export{Q as default};
