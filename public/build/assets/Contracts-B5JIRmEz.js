import{r as l,j as t,y as d,a as p}from"./app-CJl1LCko.js";import{A as h,a as g}from"./Autocomplete-Cy6yj1hP.js";import{P as f}from"./PrimaryButton-DHAo9yMn.js";import{g as j,b as y,c as b}from"./functions-Dak7x-2Q.js";import{X as k}from"./transition-C8o8iGlb.js";import{c as u}from"./createLucideIcon-B9nH5JaY.js";import{S as N}from"./square-pen-xYkzSSl0.js";import{P as w}from"./Pagination-DNkhU4qk.js";import{E as C}from"./EmptyList-W0dnWjtU.js";import{A as v,I as L}from"./InsideLayout-Brt2UVd1.js";import{C as F}from"./circle-plus-Di5cO26p.js";import"./loader-circle-BlkUVlm6.js";import"./settings-BIJA3b73.js";/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=u("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=u("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function S(){const e=new URLSearchParams(window.location.search),[s,r]=l.useState({}),n=a=>{a.preventDefault(),d.get(route("contracts.index"),{...s})};return t.jsx("div",{className:"mb-5 py-3",children:t.jsxs("form",{onSubmit:n,method:"get",className:"flex items-end gap-2",children:[t.jsx(h,{placeholder:"إختر زبونا",dataFunction:async a=>g("clients",a),defaultValue:e.get("client_id"),choiceHandler:a=>r(i=>({...i,client_id:a})),listItemAtributeName:"full_name",id:"contract-filter-form",label:"الزبون"}),t.jsx(f,{type:"submit",className:"w-24",children:"بحث"})]})})}const T=({bonds:e})=>t.jsx("div",{className:"flex max-w-28 flex-wrap gap-1",children:e.map((s,r)=>t.jsx("div",{className:`h-4 w-4 rounded-full ${s}`},r))}),m=l.createContext(),o=({children:e})=>{const[s,r]=l.useState(!1),n=a=>{a.stopPropagation(),r(i=>!i)};return t.jsx(m.Provider,{value:{open:s,setOpen:r,toggleOpen:n},children:t.jsx("div",{className:"relative",children:e})})},_=({children:e})=>{const{open:s,setOpen:r,toggleOpen:n}=l.useContext(m);return t.jsxs(t.Fragment,{children:[t.jsx("div",{onClick:n,children:e}),s&&t.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>r(!1)})]})},E=({align:e="right",width:s="48",contentClasses:r="py-1 bg-white",children:n})=>{const{open:a,setOpen:i}=l.useContext(m);let c="origin-top";e==="left"?c="ltr:origin-top-left rtl:origin-top-right start-0":e==="right"&&(c="ltr:origin-top-right rtl:origin-top-left end-0");let x="";return s==="48"&&(x="w-48"),t.jsx(t.Fragment,{children:t.jsx(k,{show:a,enter:"transition ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsx("div",{className:`absolute z-50 mt-2 rounded-md shadow-lg ${c} ${x}`,onClick:()=>i(!1),children:t.jsx("div",{className:"rounded-md ring-1 ring-black ring-opacity-5 "+r,children:n})})})})},A=({className:e="",children:s,...r})=>t.jsx(p,{...r,className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none "+e,children:s});o.Trigger=_;o.Content=E;o.Link=A;function I({contractId:e}){function s(){d.post(route("contracts.trash",e),{_method:"patch"})}return t.jsxs(o,{children:[t.jsx(o.Trigger,{children:t.jsx("button",{className:"h-8 w-8 rounded-full bg-gray-200",children:t.jsx(P,{className:"mx-auto"})})}),t.jsxs(o.Content,{children:[t.jsxs(o.Link,{href:route("contracts.edit",e),children:[t.jsx(N,{className:"inline-block"})," تعديل"]}),t.jsxs("button",{onClick:s,className:"px-4 py-1 text-gray-700",children:[t.jsx(D,{className:"inline-block"})," حذف"]})]})]})}function M({contract:e}){function s(){d.get(route("contracts.show",e.id))}const r=l.useMemo(()=>e.bonds.map(a=>j(a.status,a.payement_date)),[e.bonds]),n=l.useMemo(()=>y(r),[r]);return t.jsxs("tr",{className:"cursor-pointer",children:[t.jsx("td",{onClick:s,className:"hidden border-b py-4 text-start md:block",children:t.jsx("span",{className:`block rounded-lg py-2 text-center font-bold ${n.color}`,children:n.label})}),t.jsx("td",{onClick:s,className:"border-b py-4 text-start md:mr-5 md:pr-10",children:e.client.full_name}),t.jsx("td",{onClick:s,className:"me-5 border-b py-4 text-start",children:new Date(b(e.bonds)).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}),t.jsx("td",{onClick:s,className:"me-5 w-28 border-b py-4 text-start md:w-44 lg:w-72",children:t.jsx(T,{bonds:r})}),t.jsx("td",{className:"pr-3",children:t.jsx(I,{contractId:e.id})})]})}function O({contracts:e}){return t.jsxs("table",{className:"mt-12 w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"w-full",children:[t.jsx("th",{scope:"col",className:"hidden rounded-full bg-black px-2 py-1 text-start text-sm text-white md:block",children:"الحالة"}),t.jsx("th",{scope:"col",className:"mb-2 rounded-full bg-black px-2 py-1 text-start text-sm text-white md:pr-10",children:"الزبون"}),t.jsx("th",{scope:"col",className:"mb-2 rounded-full bg-black px-2 py-1 text-start text-sm text-white",children:"تاريخ الدفعة القادمة"}),t.jsx("th",{scope:"col",className:"mb-2 rounded-full bg-black px-2 py-1 text-start text-sm text-white",children:"حالةالدفعات"}),t.jsx("th",{})]})}),t.jsx("tbody",{children:e.data.map(s=>t.jsx(M,{contract:s},s.id))}),t.jsx("tfoot",{children:t.jsx("tr",{children:t.jsx("td",{colSpan:4,children:t.jsx("div",{className:"mt-12 flex justify-center",children:t.jsx(w,{data:e})})})})})]})}function W({contracts:e}){return t.jsx(v,{children:t.jsxs(L,{headerTitle:"العقود",noBack:!0,headerLink:[{label:"إضافة عقد جديد",url:"/contracts/create",icon:F}],children:[t.jsx(S,{}),t.jsx("img",{className:"w-[20rem]",src:"/icons/status_table.png",alt:"status table image"}),e.data.length>0?t.jsx(O,{contracts:e}):t.jsx(C,{model:"عقود"})]})})}export{W as default};
