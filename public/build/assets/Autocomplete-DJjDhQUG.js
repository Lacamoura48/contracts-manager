import{c as k,g as K,r as m,j as g}from"./app-XDSUIQ6L.js";import{L as X}from"./loader-circle-m7iD0LR9.js";import{c as J}from"./createLucideIcon-DKDzS86t.js";/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=J("FileQuestion",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]]),ut=async(e,t)=>{const{page:a}=t;let i=`/autocomplete/${e}?page_size=6`;for(const r in t)t[r]&&(i+=`&${r}=${t[r]}`);try{const r=await fetch(i);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const o=await r.json(),s=o.next_page_url;return{data:o.data,nextPage:s?a+1:null}}catch(r){return console.log("autocomplete",r.message),{data:[],nextPage:null}}};function Z(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var D=Z,ee=typeof k=="object"&&k&&k.Object===Object&&k,te=ee,ne=te,re=typeof self=="object"&&self&&self.Object===Object&&self,ae=ne||re||Function("return this")(),H=ae,se=H,ie=function(){return se.Date.now()},oe=ie,ce=/\s/;function ue(e){for(var t=e.length;t--&&ce.test(e.charAt(t)););return t}var le=ue,fe=le,de=/^\s+/;function ge(e){return e&&e.slice(0,fe(e)+1).replace(de,"")}var be=ge,me=H,ve=me.Symbol,V=ve,M=V,q=Object.prototype,pe=q.hasOwnProperty,he=q.toString,R=M?M.toStringTag:void 0;function ye(e){var t=pe.call(e,R),a=e[R];try{e[R]=void 0;var i=!0}catch{}var r=he.call(e);return i&&(t?e[R]=a:delete e[R]),r}var xe=ye,je=Object.prototype,Te=je.toString;function Se(e){return Te.call(e)}var we=Se,A=V,$e=xe,Oe=we,_e="[object Null]",Ie="[object Undefined]",F=A?A.toStringTag:void 0;function Ee(e){return e==null?e===void 0?Ie:_e:F&&F in Object(e)?$e(e):Oe(e)}var Re=Ee;function Ne(e){return e!=null&&typeof e=="object"}var ke=Ne,Pe=Re,Ce=ke,Le="[object Symbol]";function Me(e){return typeof e=="symbol"||Ce(e)&&Pe(e)==Le}var Ae=Me,Fe=be,B=D,Be=Ae,G=NaN,Ge=/^[-+]0x[0-9a-f]+$/i,We=/^0b[01]+$/i,ze=/^0o[0-7]+$/i,De=parseInt;function He(e){if(typeof e=="number")return e;if(Be(e))return G;if(B(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=B(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Fe(e);var a=We.test(e);return a||ze.test(e)?De(e.slice(2),a?2:8):Ge.test(e)?G:+e}var Ve=He,qe=D,C=oe,W=Ve,Qe="Expected a function",Ue=Math.max,Ke=Math.min;function Xe(e,t,a){var i,r,o,s,n,l,f=0,p=!1,v=!1,T=!0;if(typeof e!="function")throw new TypeError(Qe);t=W(t)||0,qe(a)&&(p=!!a.leading,v="maxWait"in a,o=v?Ue(W(a.maxWait)||0,t):o,T="trailing"in a?!!a.trailing:T);function h(u){var j=i,I=r;return i=r=void 0,f=u,s=e.apply(I,j),s}function O(u){return f=u,n=setTimeout(S,t),p?h(u):s}function _(u){var j=u-l,I=u-f,c=t-j;return v?Ke(c,o-I):c}function w(u){var j=u-l,I=u-f;return l===void 0||j>=t||j<0||v&&I>=o}function S(){var u=C();if(w(u))return d(u);n=setTimeout(S,_(u))}function d(u){return n=void 0,T&&i?h(u):(i=r=void 0,s)}function y(){n!==void 0&&clearTimeout(n),f=0,i=l=r=n=void 0}function E(){return n===void 0?s:d(C())}function x(){var u=C(),j=w(u);if(i=arguments,r=this,l=u,j){if(n===void 0)return O(l);if(v)return clearTimeout(n),n=setTimeout(S,t),h(l)}return n===void 0&&(n=setTimeout(S,t)),s}return x.cancel=y,x.flush=E,x}var Je=Xe;const Ye=K(Je);var L=new Map,P=new WeakMap,z=0,Ze=void 0;function et(e){return e?(P.has(e)||(z+=1,P.set(e,z.toString())),P.get(e)):"0"}function tt(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?et(e.root):e[t]}`).toString()}function nt(e){const t=tt(e);let a=L.get(t);if(!a){const i=new Map;let r;const o=new IntersectionObserver(s=>{s.forEach(n=>{var l;const f=n.isIntersecting&&r.some(p=>n.intersectionRatio>=p);e.trackVisibility&&typeof n.isVisible>"u"&&(n.isVisible=f),(l=i.get(n.target))==null||l.forEach(p=>{p(f,n)})})},e);r=o.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),a={id:t,observer:o,elements:i},L.set(t,a)}return a}function rt(e,t,a={},i=Ze){if(typeof window.IntersectionObserver>"u"&&i!==void 0){const l=e.getBoundingClientRect();return t(i,{isIntersecting:i,target:e,intersectionRatio:typeof a.threshold=="number"?a.threshold:0,time:0,boundingClientRect:l,intersectionRect:l,rootBounds:l}),()=>{}}const{id:r,observer:o,elements:s}=nt(a),n=s.get(e)||[];return s.has(e)||s.set(e,n),n.push(t),o.observe(e),function(){n.splice(n.indexOf(t),1),n.length===0&&(s.delete(e),o.unobserve(e)),s.size===0&&(o.disconnect(),L.delete(r))}}function at({threshold:e,delay:t,trackVisibility:a,rootMargin:i,root:r,triggerOnce:o,skip:s,initialInView:n,fallbackInView:l,onChange:f}={}){var p;const[v,T]=m.useState(null),h=m.useRef(),[O,_]=m.useState({inView:!!n,entry:void 0});h.current=f,m.useEffect(()=>{if(s||!v)return;let y;return y=rt(v,(E,x)=>{_({inView:E,entry:x}),h.current&&h.current(E,x),x.isIntersecting&&o&&y&&(y(),y=void 0)},{root:r,rootMargin:i,threshold:e,trackVisibility:a,delay:t},l),()=>{y&&y()}},[Array.isArray(e)?e.toString():e,v,r,i,o,s,a,l,t]);const w=(p=O.entry)==null?void 0:p.target,S=m.useRef();!v&&w&&!o&&!s&&S.current!==w&&(S.current=w,_({inView:!!n,entry:void 0}));const d=[T,O.inView,O.entry];return d.ref=d[0],d.inView=d[1],d.entry=d[2],d}function st({children:e,open:t}){return g.jsx("div",{className:`border-secondary absolute -bottom-2 left-1/2 z-20 h-[12rem] w-full -translate-x-1/2 translate-y-full overflow-y-scroll rounded-lg border bg-white p-1 text-sm shadow-lg transition-all ${t?"pointer-events-auto scale-100 opacity-100":"pointer-events-none scale-90 opacity-0"}`,children:e})}function lt({placeholder:e,dataFunction:t,choiceHandler:a,choice:i,defaultValue:r,listItemAtributeName:o,error:s,id:n,label:l}){const f=m.useRef(null),[p,v]=m.useState(!1),[T,h]=m.useState([]),[O,_]=m.useState(!0),[w,S]=m.useState(!1),[d,y]=m.useState(1),{ref:E}=at({onChange:c=>{c&&y(b=>b+1)}}),x=m.useCallback(async(c,b=!0,N=!0)=>{d===1&&b&&_(!0);const Q={q:f.current.value,id:f.current.value?"":r,page:c},$=await t(Q);($==null?void 0:$.data.length)!==0?h(N?[...$.data]:U=>[...U,...$.data]):h([]),_(!1),$!=null&&$.nextPage?S(!0):S(!1)},[d]),u=Ye(async function(c){const b=c.target.value;f.current.value=b,await x(1,!1,!0)},200);function j(c){c===!0&&(y(1),x(1,!0,!0)),setTimeout(()=>v(c),400)}function I(c,b){f.current.value=b,a(c),v(!1)}return m.useEffect(()=>{async function c(){const b=await t({q:f.current.value,id:f.current.value?"":r,page:1});f.current.value=b==null?void 0:b.data[0][o]}r&&c()},[]),m.useEffect(()=>{d!==1&&x(d,!1,!1)},[d]),g.jsxs("div",{className:"relative w-full",children:[g.jsx("label",{htmlFor:n,className:"mb-1 text-black",children:l}),g.jsx("input",{className:`w-full border-none px-2 py-2 placeholder:text-gray-400 focus:ring-black ${s?"bg-red-100":"bg-gray-100"} placeholder:text-placeholder rounded-lg`,ref:f,onBlur:()=>j(!1),onFocus:()=>j(!0),onKeyDown:c=>c.key==="Backspace"&&i&&a(""),onChange:c=>u(c),placeholder:e,id:n}),s&&g.jsx("span",{className:"text-xs text-red-600",children:s}),g.jsx(st,{open:p,children:O?g.jsx("div",{className:"text-primary",children:g.jsx("span",{className:"mx-auto mt-5 block w-fit animate-spin",children:g.jsx(X,{size:20})})}):T!=null&&T.length?g.jsxs("ul",{children:[T.map(c=>{const b=c[o],N=c.id;return g.jsx("li",{children:g.jsx("button",{type:"button",onClick:()=>I(N,b),className:"hover:bg-secondary w-full cursor-pointer rounded-md px-2 py-1 text-start transition-colors",children:b})},N)}),w&&g.jsx("li",{className:"bg-secondary mt-4 h-10 w-full animate-pulse",ref:E})]}):g.jsx("p",{className:"flex h-full w-full items-center justify-center",children:g.jsx(Y,{color:"rgb(160,160,160)",size:80})})})]})}export{lt as A,ut as a};
