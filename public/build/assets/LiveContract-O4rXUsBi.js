import{j as e,b as le,c as ie,r as F,g as he,y as Q,a as de}from"./app-Bv1FsUGM.js";import{f as V,n as Z}from"./functions-B1sCho5i.js";import{a as ce,R as ue,b as pe,F as fe,p as xe,D as me,P as z,V as _,T as o,I as ye,S as ge}from"./Rubik-Regular-eYgUVcvH.js";import{M as ve}from"./Modal-DlWt9QK7.js";import{P as N}from"./PrimaryButton-D8KxzKFw.js";import{F as _e}from"./FileInput-rch8J89x.js";import{M as be}from"./mail-BtdRYItr.js";import{c as je}from"./createLucideIcon-BEqXvAMZ.js";import"./transition-CRl0CfcJ.js";/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=je("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);ce.register({family:"rubik",fonts:[{src:ue,fontWeight:"normal"},{src:pe,fontWeight:"bold"}]});const n=ge.create({page:{padding:30,flexDirection:"rtl",textAlign:"right",fontFamily:"rubik",fontSize:9,lineHeight:1.5},topLeft:{position:"absolute",top:70,left:30},topRight:{position:"absolute",top:70,right:30},signatureCard:{border:1,borderColor:"#aaa",borderRadius:6,padding:10,flex:1},textMd:{fontSize:12},bigTitle:{fontWeight:"bold",fontSize:28,textAlign:"center",marginBottom:12},itemsCenter:{alignItems:"center",justifyContent:"flex-end"},signatureImage:{maxWidth:80,maxHeight:80,marginHorizontal:"auto"},bold:{fontWeight:"bold"},emptyTitle:{fontSize:22,color:"rgb(180,180,230)"},intro:{fontWeight:"bold",fontSize:12,textDecoration:"underline",marginBottom:12},textCenter:{textAlign:"center"},smallMb:{marginBottom:12},esmallMb:{marginBottom:6},eesmallMb:{marginBottom:3},flexSmallGap:{display:"flex",flexDirection:"row",gap:5},flexBetween:{display:"flex",flexDirection:"row",justifyContent:"space-between"},textLg:{fontSize:16,marginTop:14,marginBottom:6},padwhiteBg:{borderRadius:6,padding:3,backgroundColor:"white"},emptyCard:{height:120,alignItems:"center",justifyContent:"center"},squareCard:{backgroundColor:"rgb(220,220,240)",borderRadius:8,flex:1,padding:10},bondsGrid:{flexDirection:"row",flexWrap:"wrap",gap:5},bondCard:{width:265,backgroundColor:"rgb(220,220,240)",borderRadius:8,padding:10},smallText:{fontSize:8,gap:8}}),Ce=["الأولى","الثانية","الثالثة","الرابعة","الخامسة","السادسة","السابعة","الثامنة","التاسعة","العاشرة","الحادية عشرة","الثانية عشرة"],Pe=({contract:t,terms:a})=>{var s;return e.jsxs(me,{children:[e.jsxs(z,{size:"A4",style:n.page,children:[e.jsxs(_,{style:[n.topLeft,n.signatureCard,n.flexSmallGap,n.itemsCenter],children:[e.jsx(o,{children:V(new Date(t.created_at))}),e.jsx(o,{style:n.bold,children:": انه في تاريخ"})]}),e.jsxs(_,{style:[n.topRight,n.signatureCard,n.flexSmallGap,n.itemsCenter],children:[e.jsx(o,{children:t.code}),e.jsx(o,{style:n.bold,children:": الرقم التسلسلي للعقد "})]}),e.jsx(o,{style:n.bigTitle,children:"عقد تصنيع وتوريد اثاث"}),e.jsx(o,{style:[n.intro,n.textCenter],children:"مقدمة"}),e.jsx(o,{style:[n.textCenter,n.smallMb],children:"وبعون من الله تعالى تم الاتفاق بين كل من"}),e.jsxs(_,{style:[n.flexSmallGap,n.esmallMb],children:[e.jsxs(_,{style:n.squareCard,children:[e.jsx(o,{style:[n.intro],children:"الطرف الثاني"}),e.jsxs(_,{style:[n.flexSmallGap,n.itemsCenter,n.esmallMb],children:[e.jsx(o,{style:n.padwhiteBg,children:t.client.full_name}),e.jsx(o,{children:"الاسم الكامل"})]}),e.jsxs(_,{style:[n.flexSmallGap,n.itemsCenter,n.esmallMb],children:[e.jsx(o,{style:n.padwhiteBg,children:t.client.phone}),e.jsx(o,{style:n.esmallMb,children:"الهاتف"})]}),e.jsxs(_,{style:[n.flexSmallGap,n.itemsCenter,n.esmallMb],children:[e.jsx(o,{style:n.padwhiteBg,children:t.client.id_code}),e.jsx(o,{style:n.esmallMb,children:"رقم الهوية"})]}),e.jsxs(_,{style:[n.flexSmallGap,n.itemsCenter,n.esmallMb],children:[e.jsx(o,{style:n.padwhiteBg,children:t.client.email}),e.jsx(o,{children:"الايميل"})]})]}),e.jsxs(_,{style:n.squareCard,children:[e.jsx(o,{style:[n.intro],children:"الطرف الأول"}),e.jsx(o,{style:[n.esmallMb,n.textCenter],children:t.user.company}),e.jsxs(o,{style:[n.esmallMb,n.textCenter],children:["رخصة رقم ",t.user.code]}),e.jsxs(o,{style:[n.esmallMb,n.textCenter],children:["هاتف: ",t.user.phone]}),e.jsxs(o,{style:[n.esmallMb,n.textCenter],children:["العنوان: ",t.user.address]})]})]}),e.jsx(o,{style:n.intro,children:"تمهيد"}),e.jsx(o,{style:n.smallMb,children:"فإنه ولما كان الطرف الثاني يرغب في تصنيع وتوريد أعمال أثاث مغربي وحيت أن الطرف الاول مختص في هذا النوع من الأعمال فقد اتفق الطرفان على ما يلي"}),e.jsxs(_,{style:n.squareCard,children:[e.jsx(o,{style:[n.intro,n.textLg],children:"البند الأول"}),e.jsx(o,{children:"تعتبر المقدمة وموضوع العقد جزء لا يتجزأ من هذا العقد"}),e.jsx(o,{style:[n.intro,n.textLg],children:"البند الثاني"}),e.jsx(o,{children:"يتعهد الطرف الاول بتوريد الأغراض حسب المتفق عليه في العقد"}),e.jsx(o,{style:[n.intro,n.textLg],children:"البند الثالث: مدة الإنجاز"}),e.jsx(o,{children:"توعد الطرف الأول بإنجاز الأعمال وتسليمها خلال"}),e.jsxs(_,{style:[n.padwhiteBg,n.flexSmallGap,{flexDirection:"row-reverse"}],children:[e.jsx(o,{children:t.work_duration}),e.jsx(o,{children:+t.work_duration>10?"يوم عمل":"أيام عمل"})]}),e.jsx(o,{children:"ابتداء من تاريخ أول دفعة الذي سيتم ذكره في البند الخامس"}),e.jsx(o,{style:[n.intro,n.textLg],children:"البند الرابع: قيمة العقد"}),e.jsx(o,{children:"اتفق الطرفان على أن يقوم الطرف الاول بتصنيع وتوريد الأثاث طبقا للأسعار التالية ذكرها حسب ما هو موضح تفصيلا في عرض السعر بمبلغ إجمالى وقدره"}),e.jsx(o,{style:[n.padwhiteBg,n.esmallMb,n.textMd],children:Z(Math.round(parseFloat(t.bonds_sum_amount).toFixed(2)))}),e.jsx(o,{children:"على ان يلتزم الطرف الثاني بتواريخ الدفع المذكورة في العقد وفي حال تخلفه عن السداد في التواريخ المذكورة سلفا يحق للطرف الأول اتخاد كافة الإجراءات القانونية التي تضمن حقه"}),e.jsx(o,{style:[n.intro,n.textLg],children:"البند الخامس: الدفعات"}),e.jsx(o,{children:"تم الاتفاق بين الطرفين أن تتم المحاسبة ودفع المبلغ على عدد"}),e.jsxs(_,{style:[n.padwhiteBg,n.flexSmallGap,{flexDirection:"row-reverse"}],children:[e.jsx(o,{children:t.bonds_count}),e.jsx(o,{children:+t.bonds_count>10?"دفعة":"دفعات"})]}),e.jsx(o,{children:"دفعات حسب جدول التواريخ التالية ذكرها"})]})]}),e.jsx(z,{size:"A4",style:n.page,children:e.jsx(_,{style:[n.bondsGrid,n.esmallMb,{flexDirection:"row-reverse"}],children:[...Array(12).keys()].map(r=>{const i=t.bonds[r];return i?e.jsxs(_,{style:n.bondCard,children:[e.jsxs(o,{style:[n.intro,{marginBottom:6}],children:["الدفعة ",Ce[r]]}),e.jsxs(_,{children:[e.jsxs(_,{style:[n.flexSmallGap,n.itemsCenter,n.eesmallMb],children:[e.jsx(o,{style:[n.padwhiteBg,{flex:1,fontSize:8}],children:Z(parseFloat(i.amount))}),e.jsx(o,{style:{width:28},children:"قدرها "})]}),e.jsxs(_,{style:[n.flexSmallGap,n.itemsCenter,n.esmallMb],children:[e.jsx(o,{style:[n.padwhiteBg,{flex:1}],children:parseFloat(i.amount).toFixed(2)}),e.jsx(o,{children:"بالأرقام"})]}),e.jsxs(_,{style:[n.flexSmallGap,n.itemsCenter],children:[e.jsx(o,{style:[n.padwhiteBg,{flex:1}],children:V(new Date(i.payement_date))}),e.jsx(o,{style:{width:28},children:"بتاريخ"})]})]})]},r):e.jsx(_,{style:[n.bondCard,n.emptyCard],children:e.jsx(o,{style:n.emptyTitle,children:"فارغ"})},r)})})}),e.jsx(z,{size:"A4",style:n.page,children:e.jsxs(_,{style:n.squareCard,children:[e.jsx(o,{style:[n.intro,n.textLg],children:"البند السادس: المواصفات"}),e.jsx(o,{style:n.intro,children:"نوع الاسفنج"}),e.jsx(o,{style:n.smallMb,children:"اتفق الطرفان استخدام الاسفنج طبق للمواصفات التالية"}),e.jsxs(_,{style:[n.smallMb,{gap:6,flexDirection:"row-reverse"}],children:[e.jsxs(o,{style:n.padwhiteBg,children:[t.intensity," الكثافة"]}),e.jsxs(o,{style:n.padwhiteBg,children:[t.width," عرض"]}),e.jsxs(o,{style:n.padwhiteBg,children:[t.height," ارتفاع"]})]}),e.jsx(o,{style:n.intro,children:"نوع القماش والخياطة"}),e.jsx(o,{style:n.smallMb,children:"اتفق الطرفان استخدام القماش الذي تم اختیاره وتم ارسال الصور عبر منصة واتساب وتم الموافقة عليها"}),e.jsx(o,{style:n.intro,children:"شكل وتصميم الخشب"}),e.jsx(o,{style:n.smallMb,children:"اتفق الطرفان على التصميم حسب ما تم اخياره من النماذج المتوفرة بالمعرض والتي تم ارسال صورها عبر منصة واتساب وتم الموافقة عليها"}),((s=t.files)==null?void 0:s.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(o,{style:n.intro,children:"ملاحظات"}),e.jsx(_,{style:[n.padwhiteBg,n.smallMb],children:t.files.map((r,i)=>e.jsx(o,{children:r.title},i))})]}),e.jsx(o,{style:n.intro,children:"تنویه"}),e.jsx(o,{style:{fontSize:10},children:"تعتبر المحادثات بين الطرفين عبر منصة واتساب والتي يوضح فيها الطرف الأول للطرف الثاني تفاصيل عن الاعمال المتفق عليها جزءا لا يتجزأ من العقد حيت انها توضح وتبين بوضوح ما تم ذكره بالعقد اما عن طريق فيديوهات او صور لما تم اختياره والموافقة عليه"})]})}),e.jsxs(z,{style:n.page,children:[e.jsxs(_,{style:[n.squareCard,n.smallMb],children:[e.jsx(o,{style:[n.intro],children:"الشروط والاحكام"}),e.jsx(_,{children:a.map(r=>e.jsx(o,{style:[n.eesmallMb,n.smallText],children:r.terms},r.id))}),e.jsx(o,{style:[n.intro,n.textLg],children:"البند السابع: الاقرارات"}),e.jsx(o,{children:"اقر الطرفان بانهما اطلعا ووافقا على بنود هذا العقد وحرر من نسختين بعد ان تم توقيعه من الطرفين"})]}),e.jsxs(_,{style:n.bondsGrid,children:[e.jsxs(_,{style:n.signatureCard,children:[e.jsx(o,{style:[n.intro],children:"الطرف الثانى"}),t.signature&&e.jsx(ye,{style:n.signatureImage,src:t.signature})]}),e.jsx(_,{style:n.signatureCard,children:e.jsx(o,{style:[n.intro],children:"الطرف الأول"})})]})]})]})},Me=({contract:t,terms:a})=>{const s=async()=>{const i=await xe(e.jsx(Pe,{terms:a,contract:t})).toBlob(),l=URL.createObjectURL(i);window.open(l,"_blank")};return e.jsxs("button",{onClick:s,className:"relative top-1 rounded-full border border-black py-1 pl-4 pr-1 transition-colors duration-500 hover:bg-black hover:text-white",children:[e.jsx(fe,{className:"ml-2 mr-1 inline"}),"فتح PDF"]})};var se={exports:{}},q={exports:{}},I,ee;function Se(){if(ee)return I;ee=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return I=t,I}var G,te;function Te(){if(te)return G;te=1;var t=Se();function a(){}function s(){}return s.resetWarningCache=a,G=function(){function r(h,c,f,d,p,x){if(x!==t){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}r.isRequired=r;function i(){return r}var l={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:s,resetWarningCache:a};return l.PropTypes=l,l},G}var ne;function De(){return ne||(ne=1,q.exports=Te()()),q.exports}/*!
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
 */function B(t,a,s){this.x=t,this.y=a,this.time=s||new Date().getTime()}B.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1};B.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))};B.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time};function $(t,a,s,r){this.startPoint=t,this.control1=a,this.control2=s,this.endPoint=r}$.prototype.length=function(){for(var t=10,a=0,s=void 0,r=void 0,i=0;i<=t;i+=1){var l=i/t,h=this._point(l,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),c=this._point(l,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(i>0){var f=h-s,d=c-r;a+=Math.sqrt(f*f+d*d)}s=h,r=c}return a};$.prototype._point=function(t,a,s,r,i){return a*(1-t)*(1-t)*(1-t)+3*s*(1-t)*(1-t)*t+3*r*(1-t)*t*t+i*t*t*t};function ke(t,a,s){var r,i,l,h=null,c=0;s||(s={});var f=function(){c=s.leading===!1?0:Date.now(),h=null,l=t.apply(r,i),h||(r=i=null)};return function(){var d=Date.now();!c&&s.leading===!1&&(c=d);var p=a-(d-c);return r=this,i=arguments,p<=0||p>a?(h&&(clearTimeout(h),h=null),c=d,l=t.apply(r,i),h||(r=i=null)):!h&&s.trailing!==!1&&(h=setTimeout(f,p)),l}}function b(t,a){var s=this,r=a||{};this.velocityFilterWeight=r.velocityFilterWeight||.7,this.minWidth=r.minWidth||.5,this.maxWidth=r.maxWidth||2.5,this.throttle="throttle"in r?r.throttle:16,this.minDistance="minDistance"in r?r.minDistance:5,this.throttle?this._strokeMoveUpdate=ke(b.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=b.prototype._strokeUpdate,this.dotSize=r.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=r.penColor||"black",this.backgroundColor=r.backgroundColor||"rgba(0,0,0,0)",this.onBegin=r.onBegin,this.onEnd=r.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(i){i.which===1&&(s._mouseButtonDown=!0,s._strokeBegin(i))},this._handleMouseMove=function(i){s._mouseButtonDown&&s._strokeMoveUpdate(i)},this._handleMouseUp=function(i){i.which===1&&s._mouseButtonDown&&(s._mouseButtonDown=!1,s._strokeEnd(i))},this._handleTouchStart=function(i){if(i.targetTouches.length===1){var l=i.changedTouches[0];s._strokeBegin(l)}},this._handleTouchMove=function(i){i.preventDefault();var l=i.targetTouches[0];s._strokeMoveUpdate(l)},this._handleTouchEnd=function(i){var l=i.target===s._canvas;l&&(i.preventDefault(),s._strokeEnd(i))},this.on()}b.prototype.clear=function(){var t=this._ctx,a=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,a.width,a.height),t.fillRect(0,0,a.width,a.height),this._data=[],this._reset(),this._isEmpty=!0};b.prototype.fromDataURL=function(t){var a=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=new Image,i=s.ratio||window.devicePixelRatio||1,l=s.width||this._canvas.width/i,h=s.height||this._canvas.height/i;this._reset(),r.src=t,r.onload=function(){a._ctx.drawImage(r,0,0,l,h)},this._isEmpty=!1};b.prototype.toDataURL=function(t){var a;switch(t){case"image/svg+xml":return this._toSVG();default:for(var s=arguments.length,r=Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];return(a=this._canvas).toDataURL.apply(a,[t].concat(r))}};b.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};b.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};b.prototype.isEmpty=function(){return this._isEmpty};b.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),typeof this.onBegin=="function"&&this.onBegin(t)};b.prototype._strokeUpdate=function(t){var a=t.clientX,s=t.clientY,r=this._createPoint(a,s),i=this._data[this._data.length-1],l=i&&i[i.length-1],h=l&&r.distanceTo(l)<this.minDistance;if(!(l&&h)){var c=this._addPoint(r),f=c.curve,d=c.widths;f&&d&&this._drawCurve(f,d.start,d.end),this._data[this._data.length-1].push({x:r.x,y:r.y,time:r.time,color:this.penColor})}};b.prototype._strokeEnd=function(t){var a=this.points.length>2,s=this.points[0];if(!a&&s&&this._drawDot(s),s){var r=this._data[this._data.length-1],i=r[r.length-1];s.equals(i)||r.push({x:s.x,y:s.y,time:s.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(t)};b.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};b.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};b.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};b.prototype._createPoint=function(t,a,s){var r=this._canvas.getBoundingClientRect();return new B(t-r.left,a-r.top,s||new Date().getTime())};b.prototype._addPoint=function(t){var a=this.points,s=void 0;if(a.push(t),a.length>2){a.length===3&&a.unshift(a[0]),s=this._calculateCurveControlPoints(a[0],a[1],a[2]);var r=s.c2;s=this._calculateCurveControlPoints(a[1],a[2],a[3]);var i=s.c1,l=new $(a[1],r,i,a[2]),h=this._calculateCurveWidths(l);return a.shift(),{curve:l,widths:h}}return{}};b.prototype._calculateCurveControlPoints=function(t,a,s){var r=t.x-a.x,i=t.y-a.y,l=a.x-s.x,h=a.y-s.y,c={x:(t.x+a.x)/2,y:(t.y+a.y)/2},f={x:(a.x+s.x)/2,y:(a.y+s.y)/2},d=Math.sqrt(r*r+i*i),p=Math.sqrt(l*l+h*h),x=c.x-f.x,m=c.y-f.y,w=p/(d+p),v={x:f.x+x*w,y:f.y+m*w},C=a.x-v.x,M=a.y-v.y;return{c1:new B(c.x+C,c.y+M),c2:new B(f.x+C,f.y+M)}};b.prototype._calculateCurveWidths=function(t){var a=t.startPoint,s=t.endPoint,r={start:null,end:null},i=this.velocityFilterWeight*s.velocityFrom(a)+(1-this.velocityFilterWeight)*this._lastVelocity,l=this._strokeWidth(i);return r.start=this._lastWidth,r.end=l,this._lastVelocity=i,this._lastWidth=l,r};b.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)};b.prototype._drawPoint=function(t,a,s){var r=this._ctx;r.moveTo(t,a),r.arc(t,a,s,0,2*Math.PI,!1),this._isEmpty=!1};b.prototype._drawCurve=function(t,a,s){var r=this._ctx,i=s-a,l=Math.floor(t.length());r.beginPath();for(var h=0;h<l;h+=1){var c=h/l,f=c*c,d=f*c,p=1-c,x=p*p,m=x*p,w=m*t.startPoint.x;w+=3*x*c*t.control1.x,w+=3*p*f*t.control2.x,w+=d*t.endPoint.x;var v=m*t.startPoint.y;v+=3*x*c*t.control1.y,v+=3*p*f*t.control2.y,v+=d*t.endPoint.y;var C=a+d*i;this._drawPoint(w,v,C)}r.closePath(),r.fill()};b.prototype._drawDot=function(t){var a=this._ctx,s=typeof this.dotSize=="function"?this.dotSize():this.dotSize;a.beginPath(),this._drawPoint(t.x,t.y,s),a.closePath(),a.fill()};b.prototype._fromData=function(t,a,s){for(var r=0;r<t.length;r+=1){var i=t[r];if(i.length>1)for(var l=0;l<i.length;l+=1){var h=i[l],c=new B(h.x,h.y,h.time),f=h.color;if(l===0)this.penColor=f,this._reset(),this._addPoint(c);else if(l!==i.length-1){var d=this._addPoint(c),p=d.curve,x=d.widths;p&&x&&a(p,x,f)}}else{this._reset();var m=i[0];s(m)}}};b.prototype._toSVG=function(){var t=this,a=this._data,s=this._canvas,r=Math.max(window.devicePixelRatio||1,1),i=0,l=0,h=s.width/r,c=s.height/r,f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.setAttributeNS(null,"width",s.width),f.setAttributeNS(null,"height",s.height),this._fromData(a,function(g,D,E){var k=document.createElement("path");if(!isNaN(g.control1.x)&&!isNaN(g.control1.y)&&!isNaN(g.control2.x)&&!isNaN(g.control2.y)){var A="M "+g.startPoint.x.toFixed(3)+","+g.startPoint.y.toFixed(3)+" "+("C "+g.control1.x.toFixed(3)+","+g.control1.y.toFixed(3)+" ")+(g.control2.x.toFixed(3)+","+g.control2.y.toFixed(3)+" ")+(g.endPoint.x.toFixed(3)+","+g.endPoint.y.toFixed(3));k.setAttribute("d",A),k.setAttribute("stroke-width",(D.end*2.25).toFixed(3)),k.setAttribute("stroke",E),k.setAttribute("fill","none"),k.setAttribute("stroke-linecap","round"),f.appendChild(k)}},function(g){var D=document.createElement("circle"),E=typeof t.dotSize=="function"?t.dotSize():t.dotSize;D.setAttribute("r",E),D.setAttribute("cx",g.x),D.setAttribute("cy",g.y),D.setAttribute("fill",g.color),f.appendChild(D)});var d="data:image/svg+xml;base64,",p='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+i+" "+l+" "+h+" "+c+'"')+(' width="'+h+'"')+(' height="'+c+'"')+">",x=f.innerHTML;if(x===void 0){var m=document.createElement("dummy"),w=f.childNodes;m.innerHTML="";for(var v=0;v<w.length;v+=1)m.appendChild(w[v].cloneNode(!0));x=m.innerHTML}var C="</svg>",M=p+x+C;return d+btoa(M)};b.prototype.fromData=function(t){var a=this;this.clear(),this._fromData(t,function(s,r){return a._drawCurve(s,r.start,r.end)},function(s){return a._drawDot(s)}),this._data=t};b.prototype.toData=function(){return this._data};const Ee=Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"})),Re=le(Ee);var H={exports:{}},re;function Be(){return re||(re=1,function(t,a){(function(s,r){t.exports=r()})(ie,function(){return function(s){function r(l){if(i[l])return i[l].exports;var h=i[l]={exports:{},id:l,loaded:!1};return s[l].call(h.exports,h,h.exports,r),h.loaded=!0,h.exports}var i={};return r.m=s,r.c=i,r.p="",r(0)}([function(s,r){function i(d){var p=d.getContext("2d"),x=d.width,m=d.height,w=p.getImageData(0,0,x,m).data,v=c(!0,x,m,w),C=c(!1,x,m,w),M=f(!0,x,m,w),g=f(!1,x,m,w),D=g-M+1,E=C-v+1,k=p.getImageData(M,v,D,E);return d.width=D,d.height=E,p.clearRect(0,0,D,E),p.putImageData(k,0,0),d}function l(d,p,x,m){return{red:m[4*(x*p+d)],green:m[4*(x*p+d)+1],blue:m[4*(x*p+d)+2],alpha:m[4*(x*p+d)+3]}}function h(d,p,x,m){return l(d,p,x,m).alpha}function c(d,p,x,m){for(var w=d?1:-1,v=d?0:x-1,C=v;d?C<x:C>-1;C+=w)for(var M=0;M<p;M++)if(h(M,C,p,m))return C;return null}function f(d,p,x,m){for(var w=d?1:-1,v=d?0:p-1,C=v;d?C<p:C>-1;C+=w)for(var M=0;M<x;M++)if(h(C,M,p,m))return C;return null}Object.defineProperty(r,"__esModule",{value:!0}),r.default=i}])})}(H)),H.exports}(function(t,a){(function(s,r){t.exports=r(De(),F,Re,Be())})(ie,function(s,r,i,l){return function(h){function c(d){if(f[d])return f[d].exports;var p=f[d]={exports:{},id:d,loaded:!1};return h[d].call(p.exports,p,p.exports,c),p.loaded=!0,p.exports}var f={};return c.m=h,c.c=f,c.p="",c(0)}([function(h,c,f){function d(j){return j&&j.__esModule?j:{default:j}}function p(j,y){var S={};for(var P in j)y.indexOf(P)>=0||Object.prototype.hasOwnProperty.call(j,P)&&(S[P]=j[P]);return S}function x(j,y){if(!(j instanceof y))throw new TypeError("Cannot call a class as a function")}function m(j,y){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!y||typeof y!="object"&&typeof y!="function"?j:y}function w(j,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);j.prototype=Object.create(y&&y.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(j,y):j.__proto__=y)}Object.defineProperty(c,"__esModule",{value:!0});var v=Object.assign||function(j){for(var y=1;y<arguments.length;y++){var S=arguments[y];for(var P in S)Object.prototype.hasOwnProperty.call(S,P)&&(j[P]=S[P])}return j},C=function(){function j(y,S){for(var P=0;P<S.length;P++){var u=S[P];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(y,u.key,u)}}return function(y,S,P){return S&&j(y.prototype,S),P&&j(y,P),y}}(),M=f(1),g=d(M),D=f(2),E=d(D),k=f(3),A=d(k),ae=f(4),oe=d(ae),U=function(j){function y(){var S,P,u,Y;x(this,y);for(var X=arguments.length,J=Array(X),O=0;O<X;O++)J[O]=arguments[O];return P=u=m(this,(S=y.__proto__||Object.getPrototypeOf(y)).call.apply(S,[this].concat(J))),u._sigPad=null,u._excludeOurProps=function(){var T=u.props,R=(T.canvasProps,T.clearOnResize,p(T,["canvasProps","clearOnResize"]));return R},u.getCanvas=function(){return u._canvas},u.getTrimmedCanvas=function(){var T=document.createElement("canvas");return T.width=u._canvas.width,T.height=u._canvas.height,T.getContext("2d").drawImage(u._canvas,0,0),(0,oe.default)(T)},u.getSignaturePad=function(){return u._sigPad},u._checkClearOnResize=function(){u.props.clearOnResize&&u._resizeCanvas()},u._resizeCanvas=function(){var T=u.props.canvasProps||{},R=T.width,K=T.height;if(!R||!K){var L=u._canvas,W=Math.max(window.devicePixelRatio||1,1);R||(L.width=L.offsetWidth*W),K||(L.height=L.offsetHeight*W),L.getContext("2d").scale(W,W),u.clear()}},u.on=function(){return window.addEventListener("resize",u._checkClearOnResize),u._sigPad.on()},u.off=function(){return window.removeEventListener("resize",u._checkClearOnResize),u._sigPad.off()},u.clear=function(){return u._sigPad.clear()},u.isEmpty=function(){return u._sigPad.isEmpty()},u.fromDataURL=function(T,R){return u._sigPad.fromDataURL(T,R)},u.toDataURL=function(T,R){return u._sigPad.toDataURL(T,R)},u.fromData=function(T){return u._sigPad.fromData(T)},u.toData=function(){return u._sigPad.toData()},Y=P,m(u,Y)}return w(y,j),C(y,[{key:"componentDidMount",value:function(){this._sigPad=new A.default(this._canvas,this._excludeOurProps()),this._resizeCanvas(),this.on()}},{key:"componentWillUnmount",value:function(){this.off()}},{key:"componentDidUpdate",value:function(){Object.assign(this._sigPad,this._excludeOurProps())}},{key:"render",value:function(){var S=this,P=this.props.canvasProps;return E.default.createElement("canvas",v({ref:function(u){S._canvas=u}},P))}}]),y}(D.Component);U.propTypes={velocityFilterWeight:g.default.number,minWidth:g.default.number,maxWidth:g.default.number,minDistance:g.default.number,dotSize:g.default.oneOfType([g.default.number,g.default.func]),penColor:g.default.string,throttle:g.default.number,onEnd:g.default.func,onBegin:g.default.func,canvasProps:g.default.object,clearOnResize:g.default.bool},U.defaultProps={clearOnResize:!0},c.default=U},function(h,c){h.exports=s},function(h,c){h.exports=r},function(h,c){h.exports=i},function(h,c){h.exports=l}])})})(se);var Le=se.exports;const Ne=he(Le);function Fe({show:t,signature:a,signatureProof:s,id:r,closeHandler:i}){const l=F.useRef({}),[h,c]=F.useState(),[f,d]=F.useState(),p=()=>{l.current.clear()},x=v=>{Q.post(route("contracts.sign",r),{signature:v,_method:"patch"},{onSuccess:()=>c(!0)})},m=()=>{if(l.current.isEmpty())return;const v=l.current.getTrimmedCanvas().toDataURL("image/png");x(v)};function w(v){v.preventDefault(),Q.post(route("contracts.signProof",r),{signature_proof:f,_method:"PATCH"},{onSuccess:i})}return e.jsx(ve,{show:t,children:a||h?e.jsxs("div",{className:"flex flex-col items-center py-4",children:[e.jsxs("h2",{className:"text-black",children:[e.jsx("span",{className:"font-bold text-gray-600",children:"الخطوة الثانية:"})," ","يرجى تحميل صورة هويتك، كدليل على أنك مالك التوقيع"]}),e.jsxs("form",{className:"flex w-full flex-col gap-4 px-5 py-4",onSubmit:w,children:[e.jsx(_e,{name:"signature_proof",label:"صورة بطاقة الهوية",imageSelected:f,onChange:v=>d(v.target.files[0]),id:"signature_proof_input"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{children:"إرسال"}),e.jsx(N,{onClick:i,type:"button",children:"رجوع"})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center py-4",children:[e.jsxs("h2",{className:"text-black",children:[e.jsx("span",{className:"font-bold text-gray-600",children:"الخطوة الأولى:"})," ","الرجاء التوقيع في المنطقة أدناه"]}),e.jsx(Ne,{ref:l,penColor:"black",canvasProps:{width:400,height:250,className:"sigCanvas border-2 border-gray-600 rounded-xl mb-3"}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{onClick:m,children:"تأكيد"}),e.jsx(N,{onClick:p,children:"إعادة المحاولة"}),e.jsx(N,{onClick:i,children:"رجوع"})]})]})})}function Ve({contract:t,auth:a,terms:s}){const[r,i]=F.useState(!1),l=t.bonds.filter(h=>h.status==="paid"||h.status==="posted");return e.jsxs("div",{className:"flex min-h-screen flex-col justify-center pt-5 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold md:text-3xl",children:`عقد خاص ب${t.client.full_name}`}),e.jsxs("p",{className:"mb-4 text-center text-sm text-gray-400",children:["أنشئ العقد يوم"," ",V(new Date(t.created_at))]}),e.jsxs("div",{className:"mx-auto mb-4 flex gap-4",children:[e.jsxs("div",{className:"rounded-2xl bg-gray-200 px-4 py-6",children:[e.jsx("h3",{children:"القيمة الإجمالية"}),e.jsx("p",{className:"mt-2 rounded-full bg-white px-2 py-1 text-xl font-bold",children:parseFloat(t.bonds_sum_amount).toFixed(2)})]}),e.jsxs("div",{className:"rounded-2xl bg-gray-200 px-4 py-6",children:[e.jsx("h3",{children:"الدفعات المدفوعة"}),e.jsxs("p",{className:"mt-2 rounded-full bg-white px-2 py-1 text-xl font-bold",children:[l.length,e.jsxs("span",{className:"font-normal text-gray-500",children:["/",t.bonds.length]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.user&&e.jsx(e.Fragment,{children:e.jsxs(de,{href:route("contracts.send",t.id),className:"relative top-1 rounded-full border border-black py-1 pl-4 pr-1 transition-colors duration-500 hover:bg-black hover:text-white",children:[e.jsx(be,{className:"ml-2 inline"}),"البعث للزبون"]})}),!a.user&&!t.signature_proof&&e.jsx(e.Fragment,{children:e.jsxs("button",{onClick:()=>i(!0),className:"relative top-1 rounded-full border border-black py-1 pl-4 pr-1 transition-colors duration-500 hover:bg-black hover:text-white",children:[e.jsx(we,{className:"ml-2 inline"}),"توقيع العقد"]})}),e.jsx(Me,{terms:s,auth:a,contract:t}),e.jsx(Fe,{signature:t.signature,signatureProof:t.signature_proof,show:r,id:t.id,closeHandler:()=>i(!1)})]})]})}export{Ve as default};
