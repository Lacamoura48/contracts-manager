import{r as l,j as e,y as x,a as u}from"./app-CBOB9SpJ.js";import{A as h,a as j}from"./Autocomplete-rGSn_IPj.js";import{P as f}from"./PrimaryButton-3mNVqT2p.js";import{b as g,d as b,e as y}from"./functions-CzsUkF7D.js";import{X as k}from"./transition-C58hlJIf.js";import{c as p}from"./createLucideIcon-CgxyZXGI.js";import{S as N}from"./square-pen-NX96I0ZS.js";import{P as C}from"./Pagination-IG6EwlZV.js";import{E as w}from"./EmptyList-CdD9glma.js";import{A as v}from"./AuthenticatedLayout-B4jnTYur.js";import{I as L}from"./InsideLayout-C8bazwNq.js";import{C as F}from"./circle-plus-BMph0Zfx.js";import"./loader-circle-B2NsJycA.js";/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=p("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.447.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=p("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function S(){const t=new URLSearchParams(window.location.search),[s,r]=l.useState({}),n=a=>{a.preventDefault(),x.get(route("contracts.index"),{...s})};return e.jsx("div",{className:"mb-5 py-3",children:e.jsxs("form",{onSubmit:n,method:"get",className:"flex items-end gap-2",children:[e.jsx(h,{placeholder:"إختر زبونا",dataFunction:async a=>j("clients",a),defaultValue:t.get("client_id"),choiceHandler:a=>r(i=>({...i,client_id:a})),listItemAtributeName:"full_name",id:"contract-filter-form",label:"الزبون"}),e.jsx(f,{type:"submit",className:"w-24",children:"بحث"})]})})}const T=({bonds:t})=>e.jsx("div",{className:"flex max-w-28 flex-wrap gap-1",children:t.map((s,r)=>e.jsx("div",{className:`h-4 w-4 rounded-full ${s}`},r))}),d=l.createContext(),o=({children:t})=>{const[s,r]=l.useState(!1),n=a=>{a.stopPropagation(),r(i=>!i)};return e.jsx(d.Provider,{value:{open:s,setOpen:r,toggleOpen:n},children:e.jsx("div",{className:"relative",children:t})})},E=({children:t})=>{const{open:s,setOpen:r,toggleOpen:n}=l.useContext(d);return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:n,children:t}),s&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>r(!1)})]})},A=({align:t="right",width:s="48",contentClasses:r="py-1 bg-white",children:n})=>{const{open:a,setOpen:i}=l.useContext(d);let c="origin-top";t==="left"?c="ltr:origin-top-left rtl:origin-top-right start-0":t==="right"&&(c="ltr:origin-top-right rtl:origin-top-left end-0");let m="";return s==="48"&&(m="w-48"),e.jsx(e.Fragment,{children:e.jsx(k,{show:a,enter:"transition ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsx("div",{className:`absolute z-50 mt-2 rounded-md shadow-lg ${c} ${m}`,onClick:()=>i(!1),children:e.jsx("div",{className:"rounded-md ring-1 ring-black ring-opacity-5 "+r,children:n})})})})},I=({className:t="",children:s,...r})=>e.jsx(u,{...r,className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none "+t,children:s});o.Trigger=E;o.Content=A;o.Link=I;function M({contractId:t}){return e.jsxs(o,{children:[e.jsx(o.Trigger,{children:e.jsx("button",{className:"h-8 w-8 rounded-full bg-gray-200",children:e.jsx(P,{className:"mx-auto"})})}),e.jsxs(o.Content,{children:[e.jsxs(o.Link,{href:route("contracts.edit",t),children:[e.jsx(N,{className:"inline-block"})," تعديل"]}),e.jsxs(o.Link,{href:route("contracts.destroy",t),method:"delete",as:"button",children:[e.jsx(D,{className:"inline-block"})," حذف"]})]})]})}function O({contract:t}){function s(){x.get(route("contracts.show",t.id))}const r=l.useMemo(()=>t.bonds.map(a=>g(a.status,a.payement_date)),[t.bonds]),n=l.useMemo(()=>b(r),[r]);return e.jsxs("tr",{className:"cursor-pointer",children:[e.jsx("td",{onClick:s,className:"hidden border-b py-4 text-start md:block",children:e.jsx("span",{className:`block rounded-lg py-2 text-center font-bold ${n.color}`,children:n.label})}),e.jsx("td",{onClick:s,className:"border-b py-4 text-start md:mr-5 md:pr-10",children:t.client.full_name}),e.jsx("td",{onClick:s,className:"me-5 border-b py-4 text-start",children:new Date(y(t.bonds)).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsx("td",{onClick:s,className:"me-5 w-28 border-b py-4 text-start md:w-44 lg:w-72",children:e.jsx(T,{bonds:r})}),e.jsx("td",{className:"pr-3",children:e.jsx(M,{contractId:t.id})})]})}function V({contracts:t}){return e.jsxs("table",{className:"mt-12 w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"w-full border-b-2 border-b-black",children:[e.jsx("th",{scope:"col",className:"small:text-xs hidden pb-4 text-start text-base md:block",children:"الحالة"}),e.jsx("th",{scope:"col",className:"small:text-xs me-5 pb-4 text-start md:pr-10",children:"اسم الزبون"}),e.jsx("th",{scope:"col",className:"small:text-xs me-5 pb-4 text-start",children:"تاريخ الدفع التالي"}),e.jsx("th",{scope:"col",className:"small:text-xs me-5 pb-4 text-start",children:"الدفعات"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.data.map(s=>e.jsx(O,{contract:s},s.id))}),e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:4,children:e.jsx("div",{className:"mt-12 flex justify-center",children:e.jsx(C,{data:t})})})})})]})}function W({contracts:t}){return e.jsx(v,{children:e.jsxs(L,{headerTitle:"العقود",headerLink:[{label:"إضافة عقد جديد",url:"/contracts/create",icon:F}],children:[e.jsx(S,{}),t.data.length>0?e.jsx(V,{contracts:t}):e.jsx(w,{model:"عقود"})]})})}export{W as default};
